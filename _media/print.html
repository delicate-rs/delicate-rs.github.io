<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>delicate-guide</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="Roadmap.html">Introduction</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="entries.html"><strong aria-hidden="true">1.</strong> Terminology combing</a></li><li class="chapter-item expanded "><a href="quick_start.html"><strong aria-hidden="true">2.</strong> Quick start</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="quick_start_zh_cn.html"><strong aria-hidden="true">2.1.</strong> Quick start(中文)</a></li></ol></li><li class="chapter-item expanded "><a href="promotional_doc.html"><strong aria-hidden="true">3.</strong> Promotion</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="promotional_doc_zh_cn.html"><strong aria-hidden="true">3.1.</strong> Promotion(中文)</a></li></ol></li><li class="chapter-item expanded "><a href="delicate-web/index.html"><strong aria-hidden="true">4.</strong> Delicate web (Front End)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="delicate-web/index.html"><strong aria-hidden="true">4.1.</strong> Doc</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="delicate-web/layout.html"><strong aria-hidden="true">4.1.1.</strong> Layout</a></li><li class="chapter-item expanded "><a href="delicate-web/configuration.html"><strong aria-hidden="true">4.1.2.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="delicate-web/faq.html"><strong aria-hidden="true">4.1.3.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="delicate-web/getting-started.html"><strong aria-hidden="true">4.1.4.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="delicate-web/API-configuration.html"><strong aria-hidden="true">4.1.5.</strong> API configuration</a></li><li class="chapter-item expanded "><a href="delicate-web/i18n.html"><strong aria-hidden="true">4.1.6.</strong> I18n</a></li><li class="chapter-item expanded "><a href="delicate-web/_sidebar.html"><strong aria-hidden="true">4.1.7.</strong> Sidebar</a></li><li class="chapter-item expanded "><a href="delicate-web/request.html"><strong aria-hidden="true">4.1.8.</strong> Request</a></li><li class="chapter-item expanded "><a href="delicate-web/deploy.html"><strong aria-hidden="true">4.1.9.</strong> Deploy</a></li><li class="chapter-item expanded "><a href="delicate-web/change-log.html"><strong aria-hidden="true">4.1.10.</strong> Change log</a></li></ol></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/index.html"><strong aria-hidden="true">4.2.</strong> Doc(中文)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="delicate-web/zh-cn/layout.html"><strong aria-hidden="true">4.2.1.</strong> Layout</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/configuration.html"><strong aria-hidden="true">4.2.2.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/faq.html"><strong aria-hidden="true">4.2.3.</strong> FAQ</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/getting-started.html"><strong aria-hidden="true">4.2.4.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/API-configuration.html"><strong aria-hidden="true">4.2.5.</strong> API configuration</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/i18n.html"><strong aria-hidden="true">4.2.6.</strong> I18n</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/_sidebar.html"><strong aria-hidden="true">4.2.7.</strong> Sidebar</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/request.html"><strong aria-hidden="true">4.2.8.</strong> Request</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/deploy.html"><strong aria-hidden="true">4.2.9.</strong> Deploy</a></li><li class="chapter-item expanded "><a href="delicate-web/zh-cn/change-log.html"><strong aria-hidden="true">4.2.10.</strong> Change log</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">delicate-guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="what-is-delicate"><a class="header" href="#what-is-delicate">What is delicate</a></h2>
<a href="">
    <img src="./delicate_logo.png"
         alt="delicate logo" title="delicate" height="125" width="125"  align="right"/>
</a>
<p><code>delicate</code> A lightweight and distributed task scheduling platform written in rust.</p>
<h2 id="features"><a class="header" href="#features">features</a></h2>
<ul>
<li>
<p><strong>Friendly UI:</strong> [Front-end] Convenient management of tasks &amp; executors, monitoring their status and supporting manual maintenance etc.</p>
</li>
<li>
<p><strong>Flexible Operations:</strong> Flexible task operations, support for limiting the maximum number of parallelism in a single node, time zone settings corresponding to cron expressions, scheduling modes (single, fixed number, constantly repeating), the ability to manually trigger tasks at any time, manually terminate task instances, and view task logs online.</p>
</li>
<li>
<p><strong>High Availability:</strong>  Delicate supports unlimited horizontal expansion. It's easy to achieve high availability and performance by deploying as many Delicate servers and executors.</p>
</li>
<li>
<p><strong>High Performance:</strong> Lightweight and essential features speed up the performance, The basic resource overhead for <code>delicate</code> is roughly (less than 0.1% cpu usage, with about 10m of memory.)</p>
</li>
<li>
<p><strong>Observability:</strong>  There are many meaningful statistics periodically in a readable way.</p>
</li>
<li>
<p><strong>Upgrade:</strong>  Dynamic upgrade of the system (upgrade is done by obtaining the latest source code and performing database migration.</p>
</li>
<li>
<p><strong>Reusability:</strong>  Excutor provides <code>restful-api</code> that allows user applications to maintain custom tasks.</p>
</li>
</ul>
<h2 id="delicate-roadmap"><a class="header" href="#delicate-roadmap">Delicate Roadmap</a></h2>
<ul>
<li><a href="Roadmap.html#delicate-roadmap">Delicate Roadmap</a>
<ul>
<li><a href="Roadmap.html#product-principles">Product Principles</a></li>
<li><a href="Roadmap.html#features">Features</a>
<ul>
<li><a href="Roadmap.html#business-extensibility">Business Extensibility</a></li>
</ul>
</li>
<li><a href="Roadmap.html#roadmap-2021">Roadmap 2021</a></li>
</ul>
</li>
</ul>
<h2 id="product-principles"><a class="header" href="#product-principles">Product Principles</a></h2>
<ol>
<li><strong>Operability &amp; Experience</strong>.  Designed with easy-to-understand features that provide a user-friendly system experience, the job is done between silky smooth operations. </li>
</ol>
<h3 id="business-extensibility"><a class="header" href="#business-extensibility">Business Extensibility</a></h3>
<ul>
<li>Easy to develop new features with Battery-included Delicate.</li>
<li>Easy to operate/easy to install.</li>
</ul>
<h2 id="roadmap-2021"><a class="header" href="#roadmap-2021">Roadmap 2021</a></h2>
<table><thead><tr><th>Name</th><th>Issue</th><th>Description</th></tr></thead><tbody>
<tr><td>I18n</td><td></td><td>Internationalization, convenient for users in different countries and regions.</td></tr>
<tr><td>Operation Log</td><td></td><td>Record the user's operation behavior.</td></tr>
<tr><td>Permission Management</td><td></td><td>Humanized permission management to protect machine task resources and maintain system security.</td></tr>
<tr><td>Multiple login protocols</td><td></td><td>Support multiple login protocols to open up the user system within the enterprise and enhance user experience.</td></tr>
<tr><td>Machine resource panel</td><td></td><td>Powerful online resource panel with online visualization of machine / task support for multiple user actions.</td></tr>
<tr><td>Failover</td><td></td><td>Automatically migrate tasks when a node is down.</td></tr>
<tr><td>Upgrade to actix-web 4</td><td></td><td>Wait for actix-web 4 stable which will support with tokio 1 , So that <code>scheduler &amp; executor</code> communication can using RPC  (<code>tonic ｜ tarpc</code>).</td></tr>
</tbody></table>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li>
<p><a href="entries.html#executorgroup">Executor Group</a></p>
<ul>
<li><a href="entries.html#configuration-1">Configuration</a></li>
</ul>
</li>
<li>
<p><a href="entries.html#executorprocessor">Executor Processor</a></p>
<ul>
<li><a href="entries.html#configuration-2">Configuration</a></li>
</ul>
</li>
<li>
<p><a href="entries.html#executorprocessorbind">Executor Processor Bind</a></p>
<ul>
<li><a href="entries.html#configuration-3">Configuration</a></li>
</ul>
</li>
<li>
<p><a href="entries.html#task">Task</a></p>
<ul>
<li><a href="entries.html#configuration-4">Configuration</a></li>
</ul>
</li>
<li>
<p><a href="entries.html#taskinstance">Task Instance</a></p>
<ul>
<li><a href="entries.html#configuration-5">Configuration</a></li>
</ul>
</li>
<li>
<p><a href="entries.html#user">User</a></p>
<ul>
<li><a href="entries.html#configuration-6">Configuration</a></li>
</ul>
</li>
<li>
<p><a href="entries.html#statusdataaggregation">Status Data Aggregation</a></p>
</li>
<li>
<p><a href="entries.html#security">Security</a></p>
</li>
</ul>
<h2 id="executorgroup"><a class="header" href="#executorgroup">ExecutorGroup</a></h2>
<p><code>Executor Group</code> which corresponds to a service, or a business.</p>
<a href="">
    <img src="./_media/group_create.jpg"
         alt="Executor Group" title="Executor Group"  />
</a>
<h3 id="configuration-1"><a class="header" href="#configuration-1">Configuration-1</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody>
<tr><td>name</td><td>string</td><td>Group name</td><td>Yes</td></tr>
<tr><td>description</td><td>string</td><td>Group description</td><td>Yes</td></tr>
<tr><td>tag</td><td>string</td><td>Group tag</td><td>Yes</td></tr>
</tbody></table>
<h2 id="executorprocessor"><a class="header" href="#executorprocessor">ExecutorProcessor</a></h2>
<p><code>Executor Processor</code> which corresponding to a physical machine, or a container.</p>
<a href="">
    <img src="./_media/executor_list.jpg"
         alt="Executor Group" title="Executor Group"  />
</a>
<h3 id="configuration-2"><a class="header" href="#configuration-2">Configuration-2</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody>
<tr><td>name</td><td>string</td><td>Processor name</td><td>Yes</td></tr>
<tr><td>description</td><td>string</td><td>Processor description</td><td>Yes</td></tr>
<tr><td>tag</td><td>string</td><td>Processor tag</td><td>Yes</td></tr>
<tr><td>host</td><td>string</td><td>Processor host ,  No spaces between strings, (example: 12.34.56.78:9080 )</td><td>Yes</td></tr>
<tr><td>machine_id</td><td>int</td><td>Processor machine-id , Value range (0 to 1023). In order to mark custom machine serial numbers and to be able to using snowflake algorithm generate unique task-instance-id</td><td>Yes</td></tr>
</tbody></table>
<h2 id="executorprocessorbind"><a class="header" href="#executorprocessorbind">ExecutorProcessorBind</a></h2>
<p><code>Executor Processor Bind</code>, which corresponds to the association between a <code>Executor Group</code> and a <code>Executor Processor</code>, and the task needs to select the machine(Executor Processor) to execute through the association <code>Executor Processor Bind</code>. </p>
<p>Tip:</p>
<p>When there are hundreds of tasks associated with a certain <code>Executor Processor Bind</code>, it is easy to switch the machine that executes the task if you want to. Just modify the <code>Executor Processor</code> associated with the <code>Executor Processor Bind</code>, then hundreds of tasks will be removed from the old machine and executed on the new machine.</p>
<a href="">
    <img src="./_media/group_inner_bind.jpg"
         alt="Executor Processor Bind" title="Executor Processor Bind"  />
</a>
<h3 id="configuration-3"><a class="header" href="#configuration-3">Configuration-3</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody>
<tr><td>group_id</td><td>int</td><td>Group id</td><td>Yes</td></tr>
<tr><td>executor_id</td><td>int</td><td>Processor id</td><td>Yes</td></tr>
<tr><td>name</td><td>string</td><td>Binding name</td><td>Yes</td></tr>
<tr><td>weight</td><td>int</td><td>Resource Occupancy Weights</td><td>Yes</td></tr>
</tbody></table>
<h2 id="task"><a class="header" href="#task">Task</a></h2>
<p><code>Task</code> which corresponds to a set of commands given by the user that will be executed on the machine to generate task instances.</p>
<a href="">
    <img src="./_media/task_list.jpg"
         alt="Task" title="Task"  />
</a>
<h3 id="configuration-4"><a class="header" href="#configuration-4">Configuration-4</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody>
<tr><td>name</td><td>string</td><td>Task name</td><td>Yes</td></tr>
<tr><td>description</td><td>string</td><td>Task sescription</td><td>Yes</td></tr>
<tr><td>command</td><td>string</td><td>Task Commands for task execution</td><td>Yes</td></tr>
<tr><td>frequency</td><td>string</td><td>Frequency for task execution</td><td>Yes</td></tr>
<tr><td>cron_expression</td><td>string</td><td>Cron Expression for task execution</td><td>Yes</td></tr>
<tr><td>timeout</td><td>int</td><td>Cron Timeout for task execution</td><td>Yes</td></tr>
<tr><td>retry_times</td><td>int</td><td>Retry times for task execution</td><td>Yes</td></tr>
<tr><td>retry_interval</td><td>int</td><td>Retry interval for task execution</td><td>Yes</td></tr>
<tr><td>tag</td><td>string</td><td>Task's tag</td><td>Yes</td></tr>
<tr><td>binding_ids</td><td>[int]</td><td>Task's bingding</td><td>Yes</td></tr>
</tbody></table>
<h2 id="taskinstance"><a class="header" href="#taskinstance">TaskInstance</a></h2>
<p><code>Task Instance</code> which corresponds to an instance of a running task (e.g a running process).</p>
<a href="">
    <img src="./_media/task_log_detail.jpg"
         alt="TaskInstance" title="TaskInstance"  />
</a>
<h3 id="configuration-5"><a class="header" href="#configuration-5">Configuration-5</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody>
<tr><td>id</td><td>int</td><td>Unique id generated by snowflake algorithm</td><td>Yes</td></tr>
<tr><td>task_id</td><td>int</td><td>Task's id</td><td>Yes</td></tr>
<tr><td>name</td><td>string</td><td>Task name (snapshot)</td><td>Yes</td></tr>
<tr><td>description</td><td>string</td><td>Task description (snapshot)</td><td>Yes</td></tr>
<tr><td>command</td><td>string</td><td>Task's id</td><td>Yes</td></tr>
<tr><td>frequency</td><td>string</td><td>Task's frequency (snapshot)</td><td>Yes</td></tr>
<tr><td>cron_expression</td><td>string</td><td>Task's cron_expression (snapshot)</td><td>Yes</td></tr>
<tr><td>maximum_parallel_runnable_num</td><td>int</td><td>Task 'smaximum_parallel_runnable_num (snapshot)</td><td>Yes</td></tr>
<tr><td>tag</td><td>string</td><td>Task's tag (snapshot)</td><td>Yes</td></tr>
<tr><td>status</td><td>int</td><td>Task's Status Included(Running = 1,Finished = 2,AbnormalEnding = 3,TimeoutEnding = 4,TmanualCancellation = 5,Unknown = 81)</td><td>Yes</td></tr>
<tr><td>created_time</td><td>datetime</td><td>Task Instance creation time</td><td>Yes</td></tr>
<tr><td>updated_time</td><td>datetime</td><td>Task Instance Update time</td><td>Yes</td></tr>
<tr><td>executor_processor_id</td><td>int</td><td>Executor processor id</td><td>Yes</td></tr>
<tr><td>executor_processor_name</td><td>string</td><td>Executor processor name (snapshot)</td><td>Yes</td></tr>
<tr><td>executor_processor_host</td><td>string</td><td>Executor processor host</td><td>Yes</td></tr>
</tbody></table>
<h2 id="user"><a class="header" href="#user">User</a></h2>
<p><code>User</code> which corresponds to users of the system.</p>
<p>PS: When the system is first installed, you can set the initial user in <code>.env</code>.</p>
<a href="">
    <img src="./_media/user_list.jpg"
         alt="User" title="User"  />
</a>
<h3 id="configuration-6"><a class="header" href="#configuration-6">Configuration-6</a></h3>
<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Required</th></tr></thead><tbody>
<tr><td>user_name</td><td>string</td><td>User account, must be unique</td><td>Yes</td></tr>
<tr><td>nick_name</td><td>string</td><td>User nickname</td><td>Yes</td></tr>
<tr><td>mobile</td><td>string</td><td>Mobie-number(unique)</td><td>Yes</td></tr>
<tr><td>email</td><td>string</td><td>Email(unique)</td><td>Yes</td></tr>
<tr><td>certificate</td><td>string</td><td>Password credentials (the station saves the password, the station does not save or save the token)</td><td>Yes</td></tr>
</tbody></table>
<h2 id="statusdataaggregation"><a class="header" href="#statusdataaggregation">StatusDataAggregation</a></h2>
<p>delicate aggregates the task scheduling for the latest day, including: (successful scheduling, timeout, manual cancellation, abnormal end, normal end, etc.), which we can view in the home dashboard.</p>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/dashboard.jpg"
         alt="" title="delicate" align="right"/>
</a>
<h2 id="security"><a class="header" href="#security">Security</a></h2>
<p>There are two levels of security, 0 and 1.
This can be adjusted by setting the environment variable <code>DELICATE_SECURITY_LEVEL</code>.</p>
<p>At level 0, the executor and scheduler communicate without security signatures.</p>
<p>Under level 1, executor and scheduler will use RSA key for authentication when binding, and then dynamically generate a token, which will be stored in the database of scheduler, and each subsequent communication will use token &amp; sha2 hash algorithm for signature authentication.</p>
<div style="break-before: page; page-break-before: always;"></div><p>After the deployment, we can start using the delicate related functions.</p>
<p>First login via .env (<code>INITIAL_ADMINISTRATOR_USER_NAME</code>) , the initialized user.</p>
<a href="">
    <img src="./_media/login_en.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>First, we go to <code>execution-resources-executor-node</code> to maintain <code>delicate-executor</code> into our system as a machine resource and perform the activation operation.</p>
<a href="">
    <img src="./_media/executor_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="./_media/executor_create.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>Then, go to the <code>execution-resources-execution-groups</code> menu to add our resource group and do binding with the corresponding <code>execution-node</code> to generate <code>binding items</code>.</p>
<a href="">
    <img src="./_media/group_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="./_media/group_inner_bind.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>Next, go to the <code>Task List</code> to add our scheduling task and associate our <code>binding item</code>.</p>
<a href="">
    <img src="./_media/task_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="./_media/task_edit.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="./_media/task_list_operation.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="./_media/task_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>When a task starts scheduling, a scheduling log is generated, and we can click the <code>More</code> button -&gt; <code>View Log</code> for the specified task under the task list.</p>
<a href="">
    <img src="./_media/task_logs_2.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>Each task run log corresponds to a <code>task instance</code>, which can be cancelled at any time when it is running. Tasks that have finished running, or have timed out, can be viewed with standard output and standard errors generated by the task execution.</p>
<a href="">
    <img src="./_media/task_log_kill.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>For more content, please see doc.</p>
<div style="break-before: page; page-break-before: always;"></div><p>在部署之后，我们可以开始使用delicate的相关功能。</p>
<p>首先通过 .env (<code>INITIAL_ADMINISTRATOR_USER_NAME</code>) , 初始化的用户进行登陆。</p>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/login_zh.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>首先，我们进入<code>执行资源-执行节点</code>将<code>delicate-executor</code>作为机器资源维护进入我们的系统，并执行激活操作。</p>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/executor_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/executor_create.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>然后，进入<code>执行资源-执行组</code>菜单添加我们的资源组，并与对应的<code>执行节点</code>做绑定生成<code>绑定项</code>。</p>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/group_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/group_inner_bind.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>下一步，进入<code>任务列表</code>添加我们的调度任务，并关联我们的<code>绑定项</code>.</p>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_edit.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_list_operation.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>当任务开始调度后，生成调度日志，我们可以通过任务列表下的指定任务点击<code>更多</code>按钮  -&gt; <code>查看日志</code>。</p>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_logs_2.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>每一个任务的运行日志都对应着一个<code>任务实例</code>, 在运行中的任务实例是可以随时取消的。已经运行完成，或者超时的任务可以查看任务执行后产生的标准输出与标准错误。</p>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_log_kill.jpg"
         alt="" title="delicate" align="right"/>
</a>
<p>更多内容请查看doc。</p>
<div style="break-before: page; page-break-before: always;"></div><p><a href="https://github.com/BinChengZhao/delicate">delicate</a> A lightweight and distributed task scheduling platform written in rust.</p>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/delicate_logo.png"
         alt="delicate logo" title="delicate" height="125" width="125"  align="right"/>
</a>
<h2 id="features-1"><a class="header" href="#features-1">Features</a></h2>
<ul>
<li>
<p><strong>Friendly UI:</strong> [Front-end] Convenient management of tasks &amp; executors, monitoring their status and supporting manual maintenance etc.</p>
</li>
<li>
<p><strong>Flexible Operations:</strong> Flexible task operations, support for limiting the maximum number of parallelism in a single node, time zone settings corresponding to cron expressions, scheduling modes (single, fixed number, constantly repeating), the ability to manually trigger tasks at any time, manually terminate task instances, and view task logs online.</p>
</li>
<li>
<p><strong>High Availability:</strong>  Delicate supports unlimited horizontal expansion. It's easy to achieve high availability and performance by deploying as many Delicate servers and executors.</p>
</li>
<li>
<p><strong>High Performance:</strong> Lightweight and essential features speed up the performance, The basic resource overhead for <code>delicate</code> is roughly (less than 0.1% cpu usage, with about 10m of memory.)</p>
</li>
<li>
<p><strong>Observability:</strong>  There are many meaningful statistics periodically in a readable way.</p>
</li>
<li>
<p><strong>Upgrade:</strong>  Dynamic upgrade of the system (upgrade is done by obtaining the latest source code and performing database migration.</p>
</li>
</ul>
<p><img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/delicate-architecture.svg" alt="architecture" /></p>
<h2 id="technology-stack"><a class="header" href="#technology-stack">Technology-stack</a></h2>
<p>Backend: Rust<br />
main-dependencies: (actix-web &amp; diesel &amp; delay-timer &amp; serde &amp; tracing)</p>
<p>Front-end: antd-admin (React)</p>
<p>Ui: Ant Design</p>
<p>Database: mysql , postgres (plan support)</p>
<p><a href="https://github.com/BinChengZhao/delicate/blob/main/doc/quick_start.md">Quick-start</a></p>
<h2 id="whats-next"><a class="header" href="#whats-next">What's next#</a></h2>
<p>At the this year, we announced our 2021 roadmap for Delicate. So we will continue to follow this roadmap.</p>
<p><a href="https://github.com/BinChengZhao/delicate/blob/main/doc/Roadmap.md">Roadmap</a></p>
<h2 id="thanks"><a class="header" href="#thanks">Thanks</a></h2>
<p>Thank you!</p>
<p>We would like to thank the whole community and code contributors. In particular, thanks to the code contributors from the past two months:
<a href="https://github.com/Walker-os">Walker-os</a></p>
<p>Thanks to users reporting spelling mistakes on the documentation. This is always appreciated.
Thanks to users joining us provide feedbacks, discuss features, and get assistance!</p>
<h2 id="renderings"><a class="header" href="#renderings">Renderings</a></h2>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/dashboard.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_list_operation.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_logs.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_log_kill.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/executor_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/group_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/group_inner_bind.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_logs_2.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/user_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<div style="break-before: page; page-break-before: always;"></div><h2 id="a-hrefhttpsgithubcombinchengzhaodelicatedelicatea-一个轻量的分布式的任务调度平台通过rust编写"><a class="header" href="#a-hrefhttpsgithubcombinchengzhaodelicatedelicatea-一个轻量的分布式的任务调度平台通过rust编写"><a href="https://github.com/BinChengZhao/delicate">delicate</a> 一个轻量的分布式的任务调度平台通过rust编写.</a></h2>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/delicate_logo.png"
         alt="delicate logo" title="delicate" height="125" width="125"  align="right"/>
</a>
<h2 id="特性"><a class="header" href="#特性">特性</a></h2>
<ul>
<li>
<p><strong>友好的用户界面：</strong> [前端]方便地管理任务和执行器，监控其状态，支持手动维护运行中的任务等。</p>
</li>
<li>
<p><strong>灵活的操作：</strong> 灵活的任务操作，支持限制单个节点的最大并行数，与cron表达式相对应的时区设置，调度模式（单一、固定数量、不断重复），能够在任何时候手动触发任务，手动终止任务实例，在线查看任务日志。</p>
</li>
<li>
<p><strong>高可用性：</strong> Delicate支持横向扩展。通过部署尽可能多的Delicate服务器和执行器，很容易实现高可用性和性能。</p>
</li>
<li>
<p><strong>高性能:</strong> 轻量级和基本功能加快了性能，`delicate'的基本资源开销大约是（小于0.1%的cpu使用率，10m的内存.)</p>
</li>
<li>
<p><strong>可观察性:</strong> 有许多有意义的统计数据定期以图表的方式展现。</p>
</li>
<li>
<p><strong>升级:</strong> 系统的动态升级（升级是通过获得最新的源代码和进行数据库迁移.)</p>
</li>
</ul>
<p><img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/delicate-architecture.svg" alt="architecture" /></p>
<h2 id="技术栈"><a class="header" href="#技术栈">技术栈</a></h2>
<p>后端( scheduler &amp; executor ): Rust<br />
主要的依赖: (actix-web &amp; diesel &amp; delay-timer &amp; serde &amp; tracing)</p>
<p>前端: antd-admin (React)</p>
<p>Ui: Ant Design</p>
<p>数据库: mysql , postgres (计划支持)</p>
<p><a href="https://github.com/BinChengZhao/delicate/blob/main/doc/quick_start_zh_cn.md">Quick-start</a></p>
<h2 id="下一步是什么"><a class="header" href="#下一步是什么">下一步是什么</a></h2>
<p>在今年的计划中，我们宣布了2021年Delicate的路线图。因此，我们将继续遵循这个路线图.</p>
<p><a href="https://github.com/BinChengZhao/delicate/blob/main/doc/Roadmap.md">Roadmap</a></p>
<h2 id="感谢"><a class="header" href="#感谢">感谢</a></h2>
<p>谢谢你</p>
<p>我们要感谢整个社区和代码贡献者。特别是，感谢过去两个月的代码贡献者:
<a href="https://github.com/Walker-os">Walker-os</a></p>
<p>感谢用户报告文档中的拼写错误, 这非常感谢大家。
感谢用户加入我们，提供反馈，讨论功能，并获得帮助!</p>
<h2 id="效果图"><a class="header" href="#效果图">效果图</a></h2>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/dashboard.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_list_operation.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_logs.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_log_kill.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/executor_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/group_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/group_inner_bind.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/task_logs_2.jpg"
         alt="" title="delicate" align="right"/>
</a>
<a href="">
    <img src="https://delicate-rs-1301941387.cos.ap-beijing.myqcloud.com/delicate-rs/user_list.jpg"
         alt="" title="delicate" align="right"/>
</a>
<div style="break-before: page; page-break-before: always;"></div><p align="center">
  <a href="http://github.com/BinChengZhao/delicate">
    <img alt="delicate-rs" height="64" src="delicate-web/./_media/logo.png">
  </a>
</p>
<h1 align="center">Delicate</h1>
<div align="center">
<p><code>delicate</code> A lightweight and distributed task scheduling platform written in rust.</p>
<p><a href="https://github.com/BinChengZhao/delicate/issues"><img src="https://img.shields.io/github/issues/BinChengZhao/delicate.svg?style=flat-square" alt="GitHub issues" /></a>
<a href="https://github.com/BinChengZhao/delicate/actions"><img src="https://github.com/BinChengZhao/delicate/workflows/CI/badge.svg" alt="Build" /></a>
<a href="https://github.com/BinChengZhao/delicate"><img src="https://img.shields.io/badge/license-MIT%2FApache--2.0-blue.svg" alt="License" /></a>
<a href="https://github.com/BinChengZhao/delicate/pulls"><img src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square" alt="PRs Welcome" /></a></p>
</div>
<h2 id="features-2"><a class="header" href="#features-2">Features</a></h2>
<ul>
<li>Internationalization, extracting translation fields from source code, loading language packs on demand</li>
<li>Dynamic permissions, different permissions for different menus</li>
<li>Elegant and beautiful, Ant Design system</li>
<li>Mock data, local data debugging</li>
</ul>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<ol>
<li>Clone project code.</li>
</ol>
<pre><code class="language-bash">git clone https://github.com/BinChengZhao/delicate.git my-project
cd my-project
</code></pre>
<ol start="2">
<li>Installation dependence.</li>
</ol>
<pre><code class="language-bash">sudo npm install --global yarn
sudo yarn global add umi
sudo yarn install
sudo yarn build
</code></pre>
<ol start="3">
<li>Start local server.</li>
</ol>
<pre><code class="language-bash">sudo yarn start
</code></pre>
<ol start="4">
<li>After the startup is complete, open a browser and visit <a href="http://localhost:7000">http://localhost:7000</a>, If you need to change the startup port, you can configure it in the <code>.env</code> file.</li>
</ol>
<blockquote>
<p>More instructions at 。</p>
</blockquote>
<h2 id="browsers-support"><a class="header" href="#browsers-support">Browsers support</a></h2>
<p>Modern browsers.</p>
<table><thead><tr><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/edge/edge_48x48.png" alt="IE / Edge" width="24px" height="24px" /></a></br>IE / Edge</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/firefox/firefox_48x48.png" alt="Firefox" width="24px" height="24px" /></a></br>Firefox</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/chrome/chrome_48x48.png" alt="Chrome" width="24px" height="24px" /></a></br>Chrome</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/safari/safari_48x48.png" alt="Safari" width="24px" height="24px" /></a></br>Safari</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/opera/opera_48x48.png" alt="Opera" width="24px" height="24px" /></a></br>Opera</th></tr></thead><tbody>
<tr><td>IE11, Edge</td><td>last 2 versions</td><td>last 2 versions</td><td>last 2 versions</td><td>last 2 versions</td></tr>
</tbody></table>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>We very much welcome your contribution, you can build together with us in the following ways :smiley: </p>
<ul>
<li>Use Ant Design Pro in your daily work.</li>
<li>Submit <a href="http://github.com/BinChengZhao/delicate/issues">GitHub issues</a>s to report bugs or ask questions.</li>
<li>Propose <a href="http://github.com/BinChengZhao/delicate/pulls">Pull Request</a> to improve our code.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><p align="center">
  <a href="http://github.com/BinChengZhao/delicate">
    <img alt="delicate-rs" height="64" src="delicate-web/./_media/logo.png">
  </a>
</p>
<h1 align="center">Delicate</h1>
<div align="center">
<p><code>delicate</code> A lightweight and distributed task scheduling platform written in rust.</p>
<p><a href="https://github.com/BinChengZhao/delicate/issues"><img src="https://img.shields.io/github/issues/BinChengZhao/delicate.svg?style=flat-square" alt="GitHub issues" /></a>
<a href="https://github.com/BinChengZhao/delicate/actions"><img src="https://github.com/BinChengZhao/delicate/workflows/CI/badge.svg" alt="Build" /></a>
<a href="https://github.com/BinChengZhao/delicate"><img src="https://img.shields.io/badge/license-MIT%2FApache--2.0-blue.svg" alt="License" /></a>
<a href="https://github.com/BinChengZhao/delicate/pulls"><img src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square" alt="PRs Welcome" /></a></p>
</div>
<h2 id="features-3"><a class="header" href="#features-3">Features</a></h2>
<ul>
<li>Internationalization, extracting translation fields from source code, loading language packs on demand</li>
<li>Dynamic permissions, different permissions for different menus</li>
<li>Elegant and beautiful, Ant Design system</li>
<li>Mock data, local data debugging</li>
</ul>
<h2 id="usage-1"><a class="header" href="#usage-1">Usage</a></h2>
<ol>
<li>Clone project code.</li>
</ol>
<pre><code class="language-bash">git clone https://github.com/BinChengZhao/delicate.git my-project
cd my-project
</code></pre>
<ol start="2">
<li>Installation dependence.</li>
</ol>
<pre><code class="language-bash">sudo npm install --global yarn
sudo yarn global add umi
sudo yarn install
sudo yarn build
</code></pre>
<ol start="3">
<li>Start local server.</li>
</ol>
<pre><code class="language-bash">sudo yarn start
</code></pre>
<ol start="4">
<li>After the startup is complete, open a browser and visit <a href="http://localhost:7000">http://localhost:7000</a>, If you need to change the startup port, you can configure it in the <code>.env</code> file.</li>
</ol>
<blockquote>
<p>More instructions at 。</p>
</blockquote>
<h2 id="browsers-support-1"><a class="header" href="#browsers-support-1">Browsers support</a></h2>
<p>Modern browsers.</p>
<table><thead><tr><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/edge/edge_48x48.png" alt="IE / Edge" width="24px" height="24px" /></a></br>IE / Edge</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/firefox/firefox_48x48.png" alt="Firefox" width="24px" height="24px" /></a></br>Firefox</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/chrome/chrome_48x48.png" alt="Chrome" width="24px" height="24px" /></a></br>Chrome</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/safari/safari_48x48.png" alt="Safari" width="24px" height="24px" /></a></br>Safari</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/opera/opera_48x48.png" alt="Opera" width="24px" height="24px" /></a></br>Opera</th></tr></thead><tbody>
<tr><td>IE11, Edge</td><td>last 2 versions</td><td>last 2 versions</td><td>last 2 versions</td><td>last 2 versions</td></tr>
</tbody></table>
<h2 id="contributing-1"><a class="header" href="#contributing-1">Contributing</a></h2>
<p>We very much welcome your contribution, you can build together with us in the following ways :smiley: </p>
<ul>
<li>Use Ant Design Pro in your daily work.</li>
<li>Submit <a href="http://github.com/BinChengZhao/delicate/issues">GitHub issues</a>s to report bugs or ask questions.</li>
<li>Propose <a href="http://github.com/BinChengZhao/delicate/pulls">Pull Request</a> to improve our code.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="layout"><a class="header" href="#layout">Layout</a></h1>
<h2 id="add-a-new-layout"><a class="header" href="#add-a-new-layout">Add a new layout</a></h2>
<p>Take a new layout named <code>secondary</code> as an example to make the route starting with <code>secondary</code> use this layout.</p>
<ol>
<li>Add related configuration in <code>src/utils/config.js</code>. For details, please refer to <a href="delicate-web//configuration?id=layouts">layouts</a>.</li>
</ol>
<pre><code class="language-javascript">   layouts: [
           {
               name: 'primary',
               include: [/.*/],
               exclude: [/(\/(en|zh))*\/login/, /(\/(en|zh))*\/secondary\/(.*)/],
           },
           {
               name: 'secondary',
               include: [/(\/(en|zh))*\/secondary\/(.*)/],
           },
   ],
</code></pre>
<ol start="2">
<li>Add the <code>secondary</code> layout component to the <code>src/layouts/BaseLayout.js</code> file.</li>
</ol>
<pre><code class="language-javascript">   import SecondaryLayout from './SecondaryLayout'

   const LayoutMap = {
     primary: PrimaryLayout,
     public: PublicLayout,
     secondary: SecondaryLayout,
   }
</code></pre>
<ol start="3">
<li>Add the <code>SecondaryLayout.js</code> file to the <code>src/layouts/</code> directory.</li>
</ol>
<pre><code class="language-javascript">   import React from 'react'

   export default ({ children }) =&gt; {
     return (
       &lt;div&gt;
         &lt;h1&gt;Secondary&lt;/h1&gt;
         {children}
       &lt;/div&gt;
     )
   }
</code></pre>
<ol start="4">
<li>Add a <code>secondary/index.js</code> file to the <code>src/pages/</code> directory.</li>
</ol>
<pre><code class="language-javascript">   import React from 'react'

   export default ({ children }) =&gt; {
     Return &lt;div&gt;Secondary page Content&lt;/div&gt;
   }
</code></pre>
<ol start="5">
<li>Finally, start the development mode <code>npm run start</code>, open <a href="http://localhost:7000/secondary/">http://localhost:7000/secondary/</a> and you will see the page for the <code>secondary</code> layout.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="configuration"><a class="header" href="#configuration">Configuration</a></h1>
<p>You can do some custom configuration in <code>/src/utils/config.js</code>:</p>
<h2 id="sitename"><a class="header" href="#sitename">siteName</a></h2>
<ul>
<li>
<p>Type <code>String</code></p>
<p>Configure the site name, apply it to the login box, and display the title text at the top of the sidebar.</p>
</li>
</ul>
<h2 id="copyright"><a class="header" href="#copyright">copyright</a></h2>
<ul>
<li>
<p>Type： <code>String</code></p>
<p>Configure the copyright notice to apply to the login page, at the bottom of the <code>Primary</code> layout.</p>
</li>
</ul>
<h2 id="logopath"><a class="header" href="#logopath">logoPath</a></h2>
<ul>
<li>
<p>Type： <code>String</code></p>
<p>Configure the site logo to apply to the login box and the Logo display at the top of the sidebar.</p>
</li>
</ul>
<h2 id="apiprefix"><a class="header" href="#apiprefix">apiPrefix</a></h2>
<ul>
<li>
<p>Type： <code>String</code></p>
<p>Configure the prefix of the interface in the project. The interface related documents can be viewed <a href="delicate-web/API-configuration.html">API configuration</a></p>
</li>
</ul>
<h2 id="fixedheader"><a class="header" href="#fixedheader">fixedHeader</a></h2>
<ul>
<li>
<p>Type： <code>String</code></p>
<p>Under the <code>Primary</code> layout, whether the top of the page is fixed when scrolling。</p>
</li>
</ul>
<h2 id="layouts"><a class="header" href="#layouts">layouts</a></h2>
<ul>
<li>
<p>Type： <code>Array</code></p>
<p>Configuration? Which routes use which layout, unspecified route uses the default layout <code>Public</code>, the project currently has <code>Primary</code> and <code>Public</code> layouts,
     The default configuration is as follows：</p>
<pre><code class="language-javascript">    layouts: [
        {
            name: 'primary',
            include: [/.*/],
            exclude: [/(\/(en|zh))*\/login/],
        },
    ],
</code></pre>
<p>The object properties for each layout are as follows:</p>
<ul>
<li>
<p><code>name</code> - The name of the layout;</p>
</li>
<li>
<p><code>include</code> - Specifies a list of routing rules that use this layout, which can be a regular expression or a string;</p>
</li>
<li>
<p><code>exclude</code> - Specifies a list of routing rules that do not use this layout, which can be a regular expression or a string.</p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>Note: <code>exclude</code> takes precedence over <code>include</code>, and the layout previous it has a higher priority than the behind layout. The development process may need to be combined with the layout in the <code>src/layouts</code> directory. For details, see <a href="delicate-web/./layout.html">Using Layout</a>.</p>
</blockquote>
<h2 id="i18n"><a class="header" href="#i18n">i18n</a></h2>
<ul>
<li>
<p>Type： <code>Object</code></p>
<p>Configure internationalization, the default configuration is as follows:</p>
<pre><code class="language-javascript">i18n: {
    languages: [
      {
          key: 'en',
          title: 'English',
          flag: '/america.svg',
      },
      {
          key: 'zh',
          title: '中文',
          flag: '/china.svg',
      },
    ],
    defaultLanguage: 'en',
}
</code></pre>
<h3 id="i18nlanguages"><a class="header" href="#i18nlanguages">i18n.languages</a></h3>
<ul>
<li>
<p>Type： <code>Array</code></p>
<p>Specify which languages the app supports, and the object properties for each language are as follows:</p>
<ul>
<li>
<p><code>key</code> - The <code>key</code> of the language is applied to the page url to distinguish the language, and also corresponds to the language package folder name in the <code>src/locales</code> directory;</p>
</li>
<li>
<p><code>title</code> - The name of the language, at the bottom of the login page, at the top of the <code>Primary</code> layout, the language switch is displayed;</p>
</li>
<li>
<p><code>flag</code> - The path of the flag icon of the language, the language switching display at the top of the <code>Primary</code> layout.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="i18ndefaultlanguage"><a class="header" href="#i18ndefaultlanguage">i18n.defaultLanguage</a></h3>
<ul>
<li>
<p>Type： <code>String</code></p>
<p>Configure the default language.</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="faq"><a class="header" href="#faq">FAQ</a></h1>
<p>Most asked</p>
<h2 id="create-new-page"><a class="header" href="#create-new-page">create new page</a></h2>
<pre><code>1. just copy a page in /src/pages (route here auto generated by [umi](https://umijs.org/guide/router.html#basic-routing))
2. modify namespace/pathToRegexp in task.js
3. modify mock route.js to add a route
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h1>
<blockquote>
<p>Before delving into Ant Design React, a good knowledge base of <a href="http://facebook.github.io/react/">React</a> 、 <a href="http://es6.ruanyifeng.com/">ES2015+</a> 、 <a href="https://ant.design/docs/react/introduce-cn">Antd Design</a> .  Learn about <a href="https://umijs.org/">UmiJS</a> , <a href="http://github.com/dvajs/dva">Dva</a> . And properly installed and configured <a href="https://nodejs.org/">Node.js</a> v8 or above, <a href="https://git-scm.com/">Git</a>. It would be helpful if you have pre-existing knowledge on those.</p>
</blockquote>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<pre><code class="language-bash">git clone https://github.com/BinChengZhao/delicate.git my-project
cd my-project
</code></pre>
<h2 id="scaffolding"><a class="header" href="#scaffolding">Scaffolding</a></h2>
<p>The project layout is as follows:</p>
<pre><code class="language-bash">├── dist/               # Default build output directory
├── mock/               # Mock files 
├── public/             # Static resource 
├── src/                # Source code
│ ├── components/       # Components
│ ├── e2e/              # Integrated Test Case
│ ├── layouts/          # Common Layouts
│ ├── locales/          # i18n resources
│ ├── models/           # Global dva Model
│ ├── pages/            # Sub-pages and templates
│ ├── services/         # Backend Services
│ │ ├── api.js          # API configuration
│ │ └── index.js        # API export
│ ├── themes/           # Themes
│ │ ├── default.less    # Less variable
│ │ ├── index.less      # Global style
│ │ ├── mixin.less      # Less mixin
│ │ └── vars.less       # Less variable and mixin
│ ├── utils/            # Utility
│ │ ├── config.js       # Application configuration
│ │ ├── constant.js     # Static constant
│ │ ├── index.js        # Utility methods
│ │ ├── request.js      # Request function(axios)
│ │ └── theme.js        # Style variables used in js
├── .editorconfig       
├── .env                
├── .eslintrc           
├── .gitignore          
├── .prettierignore     
├── .prettierrc         
├── .stylelintrc.json   
├── .travis.yml         
└── .umirc.js           
└──  package.json      
</code></pre>
<h2 id="development"><a class="header" href="#development">Development</a></h2>
<ol>
<li>Install Dependencies.</li>
</ol>
<pre><code class="language-bash">yarn install
</code></pre>
<p>Or</p>
<pre><code class="language-bash">npm install
</code></pre>
<ol start="2">
<li>Start local server.</li>
</ol>
<pre><code class="language-bash">npm run start
</code></pre>
<ol start="3">
<li>After the startup is complete, open a browser and visit <a href="http://localhost:7000">http://localhost:7000</a>, If you need to change the startup port, you can configure it in the <code>.env</code> file.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api-configuration"><a class="header" href="#api-configuration">API configuration</a></h1>
<h2 id="why"><a class="header" href="#why">Why</a></h2>
<p>In the use of <code>redux</code> or <code>dva</code> projects, we often write functions like the following <code>service</code> layer to make the code structure clearer, but it is easy to see that we will write a lot of similar code in <code>antd -admin@5.0</code>, using the more concise configuration method to achieve the same function.</p>
<pre><code class="language-javascript">export async function login(data) {
  return request({
    url: '/api/v1/user/login',
    method: 'post',
    data,
  })
}
</code></pre>
<h2 id="configuration-and-use"><a class="header" href="#configuration-and-use">Configuration and use</a></h2>
<p>In the <code>src/services/api.js</code> file, you will see the following configuration object, the object's key is used to call the function name, the object's value is the requested <code>url</code>, the default request method is <code>GET</code>, The format of the value of the other request mode object is <code>'method url'</code>.</p>
<pre><code class="language-javascript">export default {
  ...
  queryUser: '/user/:id',
  queryUserList: '/users',
  updateUser: 'Patch /user/:id',
  createUser: 'POST /user/:id',
  removeUser: 'DELETE /user/:id',
  removeUserList: 'POST /users/delete',
  ...
}
</code></pre>
<p>Used in other files</p>
<pre><code class="language-javascript">import { queryUser } from 'api'

// in the general file
...
queryUser(option).then(data =&gt; console.log(data))
...

/ / Model file
...
yield call(queryUser, option)
...
</code></pre>
<h2 id="method-to-realize"><a class="header" href="#method-to-realize">Method to realize</a></h2>
<p>Refer to the <code>src/services/index.js</code> file to traverse the api configuration. Each property returns the corresponding encapsulated request function.</p>
<pre><code class="language-javascript">import request from 'utils/request'
import { apiPrefix } from 'utils/config'

import api from './api'

const gen = params =&gt; {
  let url = apiPrefix + params
  let method = 'GET'

  const paramsArray = params.split(' ')
  if (paramsArray.length === 2) {
    method = paramsArray[0]
    url = apiPrefix + paramsArray[1]
  }

  return function(data) {
    return request({
      url,
      data,
      method,
    })
  }
}

const APIFunction = {}
for (const key in api) {
  APIFunction[key] = gen(api[key])
}

module.exports = APIFunction

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="globalization"><a class="header" href="#globalization">globalization</a></h1>
<h2 id="add-language"><a class="header" href="#add-language">Add language</a></h2>
<p>Take Japanese as an example.</p>
<p><img src="delicate-web/../_media/term_i18n.svg" alt="i18n" /></p>
<ol>
<li>
<p>Add a language pack local file, <code>ja</code> is the Japanese language code, and a list of languages ​​that support translation <a href="http://ai.youdao.com/docs/doc-trans-api.s#p05">有道智云</a>, the <code>src/locales/ja/messages.json</code> file will be generated after running the following command.</p>
<pre><code class="language-bash ">npm run add-locale ja
</code></pre>
</li>
<li>
<p>Extract the fields in the code that need to be translated, ie <code>&lt;Trans&gt;?message&lt;/Trans&gt;</code>, <code>t`message</code> in the <code>message</code> field, run the following command after <code>src/locales/ja /messages.json</code> will appear after the extracted field configuration.</p>
<pre><code class="language-bash ">npm run extract
</code></pre>
<p>You will see the following information:</p>
<pre><code class="language-bash">Catalog statistics:
┌─────────────┬─────────────┬─────────┐
│ Language    │ Total count │ Missing │
├─────────────┼─────────────┼─────────┤
│ en (source) │     52      │    -    │
│ ja          │     52      │   52    │
│ zh          │     52      │    0    │
└─────────────┴─────────────┴─────────┘
</code></pre>
</li>
<li>
<p>At the same time, we have added the relevant configuration in <code>src/utils/config.js</code>.</p>
<pre><code class="language-javascript">{
    ...
    i18n: {
        languages: [
            ...
            {
                key:'ja',
                title: '日本語',
                flag: '/japanese.svg',
            },
        ],
    },
}
</code></pre>
<blockquote>
<p>Routing related effects, after the configuration <code>npm run start</code> takes effect after restart.</p>
</blockquote>
</li>
<li>
<p>Use the built-in commands for automatic translation. You will see the translated configuration in <code>src/locales/ja/messages.json</code>.</p>
<pre><code class="language-bash">npm run trans:only
</code></pre>
<p>You will see the following information:</p>
<pre><code class="language-bash">start: en -&gt; ja
...
youdao: en -&gt; ja: Unpublished -&gt; 未発表
youdao: en -&gt; ja: Update -&gt; 更新
youdao: en -&gt; ja: Update User -&gt; ユーザーの更新
youdao: en -&gt; ja: Username -&gt; 名
...
All translations have been completed.
</code></pre>
<blockquote>
<p><code>npm run trans</code> will execute <code>npm run extract</code> and <code>npm run trans:only</code> in order.</p>
</blockquote>
</li>
<li>
<p>Finally, you can adjust the inaccurate fields in <code>src/locales/ja/messages.json</code>. Start the development mode <code>npm run start</code>, open <a href="http://localhost:7000/ja/login">http://localhost:7000/ja/login</a> and you will see the Japanese version of the app.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li>Getting started
<ul>
<li><a href="delicate-web/getting-started.html">Quick Start</a></li>
</ul>
</li>
<li>Customization
<ul>
<li><a href="delicate-web/configuration.html">Configuration</a></li>
<li><a href="delicate-web/API-configuration.html">API Configuration</a></li>
<li><a href="delicate-web/i18n.html">I18n</a></li>
<li><a href="delicate-web/layout.html">Layout</a></li>
<li><a href="delicate-web/request.html">Request</a></li>
</ul>
</li>
<li>Guide
<ul>
<li><a href="delicate-web/deploy.html">Deploy</a></li>
</ul>
</li>
<li><a href="delicate-web/change-log.html">Change Log</a></li>
<li><a href="delicate-web/faq.html">FAQ</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http-request"><a class="header" href="#http-request">HTTP request</a></h1>
<p>this project use axios for http service, file located in src/utils/request.js</p>
<h2 id="custom-header"><a class="header" href="#custom-header">Custom Header</a></h2>
<p>As for privilege access or modify cookie, you could add header param by yourself</p>
<pre><code>axios.defaults.headers.common['Authorization'] = 'token'
</code></pre>
<p>Or</p>
<pre><code>axios.interceptors.request.use(function (config) {
  config.headers.token = window.localStorage.getItem('token');
  return config;
}, function (error) {
  return Promise.reject(error);
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deploy"><a class="header" href="#deploy">Deploy</a></h1>
<p>After the development is completed and verified in the development environment, it needs to be deployed to our users.</p>
<p><img src="delicate-web/./_media/term_build.svg" alt="i18n" /></p>
<h2 id="build"><a class="header" href="#build">Build</a></h2>
<p>First execute the following command,</p>
<pre><code class="language-bash">npm run build
</code></pre>
<p>After a few seconds, the output should look like this：</p>
<pre><code class="language-bash">&gt; delicate-rs@5.0.0-beta build /Users/delicate/delicate-web
&gt; umi build

[21:13:17] webpack compiled in 43s 868ms
 DONE  Compiled successfully in 43877ms          21:13:17

File sizes after gzip:

  1.3 MB     dist/vendors.async.js
  308.21 KB  dist/umi.js
  45.49 KB   dist/vendors.chunk.css
  36.08 KB   dist/p__chart__highCharts__index.async.js
  33.53 KB   dist/p__user__index.async.js
  22.36 KB   dist/p__chart__ECharts__index.async.js
  4.21 KB    dist/p__dashboard__index.async.js
  4.06 KB    dist/umi.css
  ...
</code></pre>
<p>The <code>build</code> command will package all resources, including JavaScript, CSS, web fonts, images, html, and more. You can find these files in the <code>dist/</code> directory.</p>
<blockquote>
<p>If you have requirements for using HashHistory , deploying html to non-root directories, statics, etc., check out [Umi Deployment] (https://umijs.org/en/guide/deploy.html).</p>
</blockquote>
<h2 id="local-verification"><a class="header" href="#local-verification">Local verification</a></h2>
<p>Local verification can be done via <code>serve</code> before publishing.</p>
<pre><code>$ yarn global add serve
$ serve ./dist

Serving!

- Local:            http://localhost:5000
- On Your Network:  http://{Your IP}:5000

Copied local address to clipboard!

</code></pre>
<p>Access <a href="http://localhost:5000">http://localhost:5000</a>, under normal circumstances, it should be consistent with <code>npm start</code> (The API may not get the correct data).</p>
<h2 id="deploy-1"><a class="header" href="#deploy-1">Deploy</a></h2>
<p>Next, we can upload the static file to the server. If you use Nginx as the Web server, you can configure it in <code>ngnix.conf</code>:</p>
<pre><code>server
	{
		listen       80;
        # Specify an accessible domain name
		server_name web.delicate-rs.com;
        # The directory where the compiled files are stored
		root  /home/www/delicate-web/dist;

        # Proxy server interface to avoid cross-domain
		location /api {
			 proxy_pass http://*.*.*.*:8090/api;
		}

         Because the front end uses BrowserHistory, it will route backback to index.html
		location / {
				index  index.html;
				try_files $uri $uri/ /index.html;
		}
	}
</code></pre>
<p>Restart the web server and access <a href="http://web.delicate-rs.com">http://web.delicate-rs.com</a> , You will see the correct page.</p>
<pre><code class="language-bash">nginx -s reload
</code></pre>
<p>Similarly, if you use Caddy as a web server, you can do this in <code>Caddyfile</code>:</p>
<pre><code>web.delicate-rs.com {
        gzip
        root /home/www/delicate-web/dist
        proxy /api http://localhost:7000

        rewrite {
                if {path} not_match ^/api
                to {path} {path}/ /
        }
}


web.delicate-rs.com/public {
        gzip
        root  /home/www/delicate-web/dist/static/public
}

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="500"><a class="header" href="#500">5.0.0</a></h2>
<h4 id="optimization"><a class="header" href="#optimization">Optimization</a></h4>
<ul>
<li>
<p>Try to use decorators to simplify code writing and improve code readability.</p>
</li>
<li>
<p>API configurization to simplify the way data is obtained.</p>
</li>
<li>
<p>The files in <code>utils</code> are split and each has its own role.</p>
</li>
<li>
<p>Simplify the <code>utils/request</code> file without special handling.</p>
</li>
</ul>
<h4 id="specification"><a class="header" href="#specification">Specification</a></h4>
<ul>
<li>
<p>Functions add comments, parameters, return values, etc., ambiguous code adds comments, canonical reference <a href="https://google.github.io/styleguide/jsguide.html#appendices-jsdoc-tag-reference">Google JavaScript Style Guide</a>.
  </p>
</li>
<li>
<p>Semantic version number, specification participation <a href="https://semver.org/lang/zh-CN/">semantic version 2.0.0</a>.</p>
</li>
<li>
<p>Static code checking, unified code style, will use <code>prettier</code>, <code>stylelint</code>, <code>eslint</code> specification code before code submission.</p>
</li>
<li>
<p>Git submits information normalization, <a href="https://github.com/liuchengxu/git-commit-emoji-cn">git-commit-emoji-cn</a>.</p>
</li>
<li>
<p>Based on the pre-defined routing of <code>Umi</code>, there is no need to write a routing configuration file.</p>
</li>
<li>
<p>Use <code>React 16</code> new features such as <code>Fragment</code>, <code>Context</code>, <code>PureComponent</code>, etc.</p>
</li>
</ul>
<h4 id="features-4"><a class="header" href="#features-4">Features</a></h4>
<ul>
<li>
<p>Support internationalization, extract source fields from source code, load language packs on demand, and automatically translate online.</p>
</li>
<li>
<p>Support for the introduction <code>lodash</code> functions on demand.
  </p>
</li>
<li>
<p>Support multiple layouts, which rules can be used according to the rules.</p>
</li>
<li>
<p>Support Antd Admin to automatically compile and deploy on Travis.</p>
</li>
<li>
<p>Generate a documentation website using <code>Docsify</code>.</p>
</li>
</ul>
<h4 id="style"><a class="header" href="#style">Style</a></h4>
<ul>
<li>
<p>Added Antd Admin standalone Logo.</p>
</li>
<li>
<p>Rewrite the overall layout component, optimize the menu, automatic breadcrumb navigation, menu auto-expansion and other logic.</p>
</li>
<li>
<p>The mobile menu is changed to drawer.</p>
</li>
</ul>
<h4 id="other"><a class="header" href="#other">Other</a></h4>
<ul>
<li>Discard components such as <code>IconFont</code>, <code>Search</code>, <code>DataTable</code> because they are well supported and replaceable in <code>Antd</code>.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><p align="center">
  <a href="http://github.com/BinChengZhao/delicate">
    <img alt="delicate-rs" height="64" src="delicate-web/zh-cn/../_media/logo.png">
  </a>
</p>
<h1 align="center"> Delicate </h1>
<div align="center">
<p>一个轻量的分布式的任务调度平台通过 rust &amp; react 编写.</p>
<p><code>delicate</code> 的前端项目是基于 &quot;antd-admin &quot;开发的，非常感谢各位。</p>
<p><a href="https://github.com/BinChengZhao/delicate/issues"><img src="https://img.shields.io/github/issues/BinChengZhao/delicate.svg?style=flat-square" alt="GitHub issues" /></a>
<a href="https://github.com/BinChengZhao/delicate/actions"><img src="https://github.com/BinChengZhao/delicate/workflows/CI/badge.svg" alt="Build" /></a>
<a href="https://github.com/BinChengZhao/delicate"><img src="https://img.shields.io/badge/license-MIT%2FApache--2.0-blue.svg" alt="License" /></a>
<a href="https://github.com/BinChengZhao/delicate/pulls"><img src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square" alt="PRs Welcome" /></a></p>
</div>
<h2 id="前端特性"><a class="header" href="#前端特性">前端特性</a></h2>
<ul>
<li>国际化，源码中抽离翻译字段，按需加载语言包</li>
<li>动态权限，不同权限对应不同菜单</li>
<li>优雅美观，Ant Design 设计体系</li>
<li>Mock 数据，本地数据调试</li>
</ul>
<h2 id="使用"><a class="header" href="#使用">使用</a></h2>
<ol>
<li>下载项目代码。</li>
</ol>
<pre><code class="language-bash">git clone https://github.com/BinChengZhao/delicate.git my-project
cd my-project
</code></pre>
<ol start="2">
<li>进入目录安装依赖，国内用户推荐使用 <a href="https://cnpmjs.org">cnpm</a> 进行加速。</li>
</ol>
<pre><code class="language-bash">sudo npm install --global yarn
sudo yarn global add umi
sudo yarn install
sudo yarn build
</code></pre>
<ol start="3">
<li>部署:
接下来，我们可以将静态文件上传到服务器。如果你使用Nginx作为Web服务器，你可以在<code>ngnix.conf</code>中配置它:</li>
</ol>
<pre><code>server
	{
		listen       80;

        # Specify an accessible domain name
		server_name web.delicate-rs.com;

        # The directory where the compiled files are stored
		root  /home/www/delicate-web/dist;

        # Proxy delicate-scheduler server .
		location /api {
            proxy_set_header   X-Forwarded-For $remote_addr;
            proxy_set_header   Host $http_host;
            proxy_pass         http://*.*.*.*:8090;
        }

        # Because the front end uses BrowserHistory, it will 
		# route back to index.html
		location / {
				index  index.html;
				try_files $uri $uri/ /index.html;
		}
	}
</code></pre>
<ol start="4">
<li>启动完成后，打开浏览器，访问<a href="http://yourdomain.com">http://yourdomain.com</a>，如果你需要改变启动端口，可以在<code>.env</code>文件中配置，而且你可以在<code>delicate-web/src/utils/envConfig.js</code>中设置<code>delicate-scheduler</code>服务端的请求地址。.</li>
</ol>
<blockquote>
<p>更多信息请参考 。</p>
</blockquote>
<h2 id="支持环境"><a class="header" href="#支持环境">支持环境</a></h2>
<p>现代浏览器。</p>
<table><thead><tr><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/edge/edge_48x48.png" alt="IE / Edge" width="24px" height="24px" /></a></br>IE / Edge</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/firefox/firefox_48x48.png" alt="Firefox" width="24px" height="24px" /></a></br>Firefox</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/chrome/chrome_48x48.png" alt="Chrome" width="24px" height="24px" /></a></br>Chrome</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/safari/safari_48x48.png" alt="Safari" width="24px" height="24px" /></a></br>Safari</th><th><a href="http://godban.github.io/browsers-support-badges/"><img src="https://raw.githubusercontent.com/alrra/browser-logos/master/src/opera/opera_48x48.png" alt="Opera" width="24px" height="24px" /></a></br>Opera</th></tr></thead><tbody>
<tr><td>IE11, Edge</td><td>last 2 versions</td><td>last 2 versions</td><td>last 2 versions</td><td>last 2 versions</td></tr>
</tbody></table>
<h2 id="参与贡献"><a class="header" href="#参与贡献">参与贡献</a></h2>
<p>我们非常欢迎你的贡献，你可以通过以下方式和我们一起共建 :smiley:</p>
<ul>
<li>在你的公司或个人项目中使用 AntD Admin。</li>
<li>通过 <a href="http://github.com/BinChengZhao/delicate/issues">Issue</a> 报告 bug 或进行咨询。</li>
<li>提交 <a href="http://github.com/BinChengZhao/delicate/pulls">Pull Request</a> 改进代码。</li>
</ul>
<blockquote>
<p>强烈推荐阅读 <a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way">《提问的智慧》</a>、<a href="https://github.com/seajs/seajs/issues/545">《如何向开源社区提问题》</a> 和 <a href="http://www.chiark.greenend.org.uk/%7Esgtatham/bugs-cn.html">《如何有效地报告 Bug》</a>、<a href="https://zhuanlan.zhihu.com/p/25795393">《如何向开源项目提交无法解答的问题》</a>，更好的问题更容易获得帮助。</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="布局"><a class="header" href="#布局">布局</a></h1>
<h2 id="新增布局"><a class="header" href="#新增布局">新增布局</a></h2>
<p>以新增名为 <code>secondary</code> 的布局为例，使以 <code>secondary</code> 开头的路由都使用该布局。</p>
<ol>
<li>
<p>在 <code>src/utils/config.js</code> 新增相关配置，参数详细请查看 <a href="delicate-web/zh-cn//zh-cn/configuration?id=layouts">layouts</a>。</p>
<pre><code class="language-javascript">layouts: [
        {
            name: 'primary',
            include: [/.*/],
            exclude: [/(\/(en|zh))*\/login/, /(\/(en|zh))*\/secondary\/(.*)/],
        },
        {
            name: 'secondary',
            include: [/(\/(en|zh))*\/secondary\/(.*)/],
        },
],
</code></pre>
</li>
<li>
<p>在<code>src/layouts/BaseLayout.js</code> 文件中新增 <code>secondary</code> 布局组件。</p>
<pre><code class="language-javascript">import SecondaryLayout from './SecondaryLayout'

const LayoutMap = {
  primary: PrimaryLayout,
  public: PublicLayout,
  secondary: SecondaryLayout,
}
</code></pre>
</li>
<li>
<p>在<code>src/layouts/</code> 目录中新增 <code>SecondaryLayout.js</code> 文件。</p>
<pre><code class="language-javascript">import React from 'react'

export default ({ children }) =&gt; {
  return (
    &lt;div&gt;
      &lt;h1&gt;Secondary&lt;/h1&gt;
      {children}
    &lt;/div&gt;
  )
}
</code></pre>
</li>
<li>
<p>在<code>src/pages/</code> 目录中新增 <code>secondary/index.js</code> 文件。</p>
<pre><code class="language-javascript">import React from 'react'

export default ({ children }) =&gt; {
  return &lt;div&gt;Secondary page Content&lt;/div&gt;
}
</code></pre>
</li>
<li>
<p>最后，启动开发模式 <code>npm run start</code>，打开 <a href="http://localhost:7000/secondary/">http://localhost:7000/secondary/</a>，你将看到 <code>secondary</code> 布局的页面。</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="配置项"><a class="header" href="#配置项">配置项</a></h1>
<p>你可以在 <code>/src/utils/config.js</code> 里做一些自定义配置：</p>
<h2 id="sitename-1"><a class="header" href="#sitename-1">siteName</a></h2>
<ul>
<li>
<p>类型： <code>String</code></p>
<p>配置站点名称，应用到登录框，侧边栏顶部的标题文字显示。</p>
</li>
</ul>
<h2 id="copyright-1"><a class="header" href="#copyright-1">copyright</a></h2>
<ul>
<li>
<p>类型： <code>String</code></p>
<p>配置版权声明，应用到登录页、<code>Primay</code>布局底部。</p>
</li>
</ul>
<h2 id="logopath-1"><a class="header" href="#logopath-1">logoPath</a></h2>
<ul>
<li>
<p>类型： <code>String</code></p>
<p>配置站点 Logo，应用到登录框，侧边栏顶部的 Logo 显示。</p>
</li>
</ul>
<h2 id="apiprefix-1"><a class="header" href="#apiprefix-1">apiPrefix</a></h2>
<ul>
<li>
<p>类型： <code>String</code></p>
<p>配置项目中接口的前缀，接口相关文档可查看 <a href="delicate-web/zh-cn/API-configuration.html">接口配置</a></p>
</li>
</ul>
<h2 id="fixedheader-1"><a class="header" href="#fixedheader-1">fixedHeader</a></h2>
<ul>
<li>
<p>类型： <code>String</code></p>
<p>在<code>Primary</code>布局下，页面滚动时是否固定顶部。</p>
</li>
</ul>
<h2 id="layouts-1"><a class="header" href="#layouts-1">layouts</a></h2>
<ul>
<li>
<p>类型： <code>Array</code></p>
<p>配置哪些路由使用哪种布局，未指定路由使用默认布局 <code>Public</code>，项目中目前有 <code>Primary</code> 和 <code>Public</code> 两种布局，
默认配置如下：</p>
<pre><code class="language-javascript">    layouts: [
        {
            name: 'primary',
            include: [/.*/],
            exclude: [/(\/(en|zh))*\/login/],
        },
    ],
</code></pre>
<p>每种布局的对象属性如下：</p>
<ul>
<li>
<p><code>name</code> - 布局的名称；</p>
</li>
<li>
<p><code>include</code> - 指定使用该布局的路由规则列表，规则可为正则表达式或者字符串；</p>
</li>
<li>
<p><code>exclude</code> - 指定不使用该布局的路由规则列表，规则可为正则表达式或者字符串。</p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>注意：<code>exclude</code> 优先级高于 <code>include</code>，前面的布局优先级高于后面的布局。开发过程中可能需要结合<code>src/layouts</code>目录下的布局使用，具体方法可查看 <a href="delicate-web/zh-cn/./layout.html">使用布局</a>。</p>
</blockquote>
<h2 id="i18n-1"><a class="header" href="#i18n-1">i18n</a></h2>
<ul>
<li>
<p>类型： <code>Object</code></p>
<p>配置国际化，默认配置如下：</p>
<pre><code class="language-javascript">i18n: {
    languages: [
      {
          key: 'en',
          title: 'English',
          flag: '/america.svg',
      },
      {
          key: 'zh',
          title: '中文',
          flag: '/china.svg',
      },
    ],
    defaultLanguage: 'en',
}
</code></pre>
<h3 id="i18nlanguages-1"><a class="header" href="#i18nlanguages-1">i18n.languages</a></h3>
<ul>
<li>
<p>类型： <code>Array</code></p>
<p>指定应用支持哪些语言，每种语言的对象属性如下：</p>
<ul>
<li>
<p><code>key</code> - 语言的<code>key</code>，应用到页面 url 上以区分语言，也对应 <code>src/locales</code> 目录下的语言包文件夹名；</p>
</li>
<li>
<p><code>title</code> - 语言名称，在登录页底部、<code>Primay</code> 布局顶部语言切换显示；</p>
</li>
<li>
<p><code>flag</code> - 语言的国旗图标的路径，在 <code>Primay</code> 布局顶部语言切换显示。</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="i18ndefaultlanguage-1"><a class="header" href="#i18ndefaultlanguage-1">i18n.defaultLanguage</a></h3>
<ul>
<li>
<p>类型： <code>String</code></p>
<p>配置默认语言。</p>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="问题集锦"><a class="header" href="#问题集锦">问题集锦</a></h1>
<h2 id="新建页面"><a class="header" href="#新建页面">新建页面</a></h2>
<pre><code>1. 直接从/src/pages复制一个page (会自动创建路由[umi](https://umijs.org/zh/guide/router.html#%E7%BA%A6%E5%AE%9A%E5%BC%8F%E8%B7%AF%E7%94%B1))
2. 修改 namespace/pathToRegexp 在 task.js
3. 修改 mock中route.js增加一条route
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="快速上手"><a class="header" href="#快速上手">快速上手</a></h1>
<blockquote>
<p>在开始之前，推荐先学习 <a href="http://facebook.github.io/react/">React</a> 、 <a href="http://es6.ruanyifeng.com/">ES2015+</a> 、 <a href="https://ant.design/docs/react/introduce-cn">Antd Design</a> , 了解 <a href="https://umijs.org/">UmiJS</a> 、<a href="http://github.com/dvajs/dva">Dva</a> ，并正确安装和配置了 <a href="https://nodejs.org/">Node.js</a> v8 或以上 、<a href="https://git-scm.com/">Git</a>。提前了解和学习这些知识会非常有帮助。</p>
</blockquote>
<h2 id="安装"><a class="header" href="#安装">安装</a></h2>
<pre><code class="language-bash">git clone https://github.com/BinChengZhao/delicate.git my-project
cd my-project
</code></pre>
<h2 id="目录结构"><a class="header" href="#目录结构">目录结构</a></h2>
<p>应用的目录结构如下</p>
<pre><code class="language-bash">├── dist/               # 默认build输出目录
├── mock/               # Mock文件目录
├── public/             # 静态资源文件目录
├── src/                # 源码目录
│ ├── components/       # 组件目录
│ ├── e2e/              # e2e目录
│ ├── layouts/          # 布局目录
│ ├── locales/          # 国际化文件目录
│ ├── models/           # 数据模型目录
│ ├── pages/            # 页面组件目录
│ ├── services/         # 数据接口目录
│ │ ├── api.js          # 接口配置
│ │ └── index.js        # 接口输出
│ ├── themes/           # 项目样式目录
│ │ ├── default.less    # 样式变量
│ │ ├── index.less      # 全局样式
│ │ ├── mixin.less      # 样式函数
│ │ └── vars.less       # 样式变量及函数
│ ├── utils/            # 工具函数目录
│ │ ├── config.js       # 项目配置
│ │ ├── constant.js     # 静态常量
│ │ ├── index.js        # 工具函数
│ │ ├── request.js      # 异步请求函数(axios)
│ │ └── theme.js        # 项目需要在js中使用到样式变量
├── .editorconfig       # 编辑器配置
├── .env                # 环境变量
├── .eslintrc           # ESlint配置
├── .gitignore          # Git忽略文件配置
├── .prettierignore     # Prettier忽略文件配置
├── .prettierrc         # Prettier配置
├── .stylelintrc.json   # Stylelint配置
├── .travis.yml         # Travis配置
└── .umirc.js           # Umi配置
└──  package.json       # 项目信息
</code></pre>
<h2 id="本地开发"><a class="header" href="#本地开发">本地开发</a></h2>
<ol>
<li>进入目录安装依赖，国内用户推荐使用 <a href="https://cnpmjs.org">cnpm</a> 进行加速</li>
</ol>
<pre><code class="language-bash">yarn install
</code></pre>
<p>或者</p>
<pre><code class="language-bash">npm install
</code></pre>
<ol start="2">
<li>启动本地服务器</li>
</ol>
<pre><code class="language-bash">npm run start
</code></pre>
<ol start="3">
<li>启动完成后打开浏览器访问 <a href="http://localhost:7000">http://localhost:7000</a>，如果需要更改启动端口，可在 <code>.env</code> 文件中配置。</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="接口配置"><a class="header" href="#接口配置">接口配置</a></h1>
<h2 id="为什么"><a class="header" href="#为什么">为什么</a></h2>
<p>在使用了<code>redux</code>或者<code>dva</code>项目中，我们经常会写类似下面的<code>service</code>层的函数，使代码结构更清晰，但是很容易看出，我们会写很多相似的代码，在<code>delicate-rs@5.0</code>中，使用了更加简洁的配置方式实现了相同的功能。</p>
<pre><code class="language-javascript">export async function login(data) {
  return request({
    url: '/api/v1/user/login',
    method: 'post',
    data,
  })
}
</code></pre>
<h2 id="配置和使用"><a class="header" href="#配置和使用">配置和使用</a></h2>
<p>在<code>src/services/api.js</code>文件中，你会看到如下配置对象，对象的键用于调用时的函数名称，对象的值为请求的<code>url</code>，默认请求方式为<code>GET</code>，如果是其他请求方式对象的值的格式则为<code>'method url'</code>。</p>
<pre><code class="language-javascript">export default {
  ...
  queryUser: '/user/:id',
  queryUserList: '/users',
  updateUser: 'Patch /user/:id',
  createUser: 'POST /user/:id',
  removeUser: 'DELETE /user/:id',
  removeUserList: 'POST /users/delete',
  ...
}
</code></pre>
<p>在其他文件中使用</p>
<pre><code class="language-javascript">import { queryUser } from 'api'

// 一般文件中
...
queryUser(option).then(data =&gt; console.log(data))
...

// model文件中
...
yield call(queryUser, option)
...
</code></pre>
<h2 id="实现方式"><a class="header" href="#实现方式">实现方式</a></h2>
<p>参考<code>src/services/index.js</code>文件，对api配置进行遍历，每个属性都返回对应的封装后的request函数。</p>
<pre><code class="language-javascript">import request from 'utils/request'
import { apiPrefix } from 'utils/config'

import api from './api'

const gen = params =&gt; {
  let url = apiPrefix + params
  let method = 'GET'

  const paramsArray = params.split(' ')
  if (paramsArray.length === 2) {
    method = paramsArray[0]
    url = apiPrefix + paramsArray[1]
  }

  return function(data) {
    return request({
      url,
      data,
      method,
    })
  }
}

const APIFunction = {}
for (const key in api) {
  APIFunction[key] = gen(api[key])
}

module.exports = APIFunction

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="国际化"><a class="header" href="#国际化">国际化</a></h1>
<h2 id="新增应用语言"><a class="header" href="#新增应用语言">新增应用语言</a></h2>
<p>以新增日语为例。</p>
<p><img src="delicate-web/zh-cn/../_media/term_i18n.svg" alt="i18n" /></p>
<ol>
<li>
<p>添加语言包本地文件，<code>ja</code> 为日语的语言代码，支持翻译的语言列表参考 <a href="http://ai.youdao.com/docs/doc-trans-api.s#p05">有道智云</a>，运行下面命令后会生成 <code>src/locales/ja/messages.json</code> 文件。</p>
<pre><code class="language-bash">npm run add-locale ja
</code></pre>
</li>
<li>
<p>提取代码中需要翻译的字段，即 <code>&lt;Trans&gt;message&lt;/Trans&gt;</code>、<code>intl.formatMessage({ id: 'message</code> 中 <code>message</code> 字段，运行下面命令后 `src/locales/ja/messages.json' }) 将会出现提取后的字段配置。</p>
<pre><code class="language-bash">npm run extract
</code></pre>
<p>你将看到如下信息：</p>
<pre><code class="language-bash"> Catalog statistics:
 ┌─────────────┬─────────────┬─────────┐
 │ Language    │ Total count │ Missing │
 ├─────────────┼─────────────┼─────────┤
 │ en (source) │     52      │    -    │
 │ ja          │     52      │   52    │
 │ zh          │     52      │    0    │
 └─────────────┴─────────────┴─────────┘
</code></pre>
</li>
<li>
<p>与此同时，我们在 <code>src/utils/config.js</code> 新增相关配置。</p>
<pre><code class="language-javascript">{
    ...
    i18n: {
        languages: [
            ...
            {
                key:'ja',
                title: '日本語',
                flag: '/japanese.svg',
            },
        ],
    },
}
</code></pre>
<blockquote>
<p> 路由相关效果，配置后 <code>npm run start</code> 重启后生效。</p>
</blockquote>
</li>
<li>
<p>使用内置的命令进行自动翻译，在 <code>src/locales/ja/messages.json</code> 中将会看到翻译后的配置。</p>
<pre><code class="language-bash">npm run trans:only
</code></pre>
<p>你将看到如下信息：</p>
<pre><code class="language-bash">start: en -&gt; ja
...
youdao: en -&gt; ja: Unpublished -&gt; 未発表
youdao: en -&gt; ja: Update -&gt; 更新
youdao: en -&gt; ja: Update User -&gt; ユーザーの更新
youdao: en -&gt; ja: Username -&gt; 名
...
All translations have been completed.
</code></pre>
<blockquote>
<p><code>npm run trans</code> 将会依次执行 <code>npm run extract</code> 和 <code>npm run trans:only</code></p>
</blockquote>
</li>
<li>
<p>最后，可以在 <code>src/locales/ja/messages.json</code> 中对翻译不准确的的字段进行调整。启动开发模式 <code>npm run start</code>，打开 <a href="http://localhost:7000/ja/login">http://localhost:7000/ja/login</a>，你将看到日语版本的应用。</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><ul>
<li>入门
<ul>
<li><a href="delicate-web/zh-cn/zh-cn/getting-started.html">快速上手</a></li>
</ul>
</li>
<li>定制化
<ul>
<li><a href="delicate-web/zh-cn/zh-cn/configuration.html">配置项</a></li>
<li><a href="delicate-web/zh-cn/zh-cn/API-configuration.html">接口配置</a></li>
<li><a href="delicate-web/zh-cn/zh-cn/i18n.html">国际化</a></li>
<li><a href="delicate-web/zh-cn/zh-cn/layout.html">布局</a></li>
<li><a href="delicate-web/zh-cn/zh-cn/request.html">http 请求</a></li>
</ul>
</li>
<li>指南
<ul>
<li><a href="delicate-web/zh-cn/zh-cn/deploy.html">部署</a></li>
</ul>
</li>
<li><a href="delicate-web/zh-cn/zh-cn/change-log.html">更新日志</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="http请求"><a class="header" href="#http请求">HTTP请求</a></h1>
<p>本项目使用了axios提供http请求服务，文件在src/utils/request.js</p>
<h2 id="自定义header"><a class="header" href="#自定义header">自定义Header</a></h2>
<p>为了提供鉴权、修改cookie等服务，可以手动修改Header</p>
<pre><code>axios.defaults.headers.common['Authorization'] = 'token'
</code></pre>
<p>或者</p>
<pre><code>// 添加请求拦截器
axios.interceptors.request.use(function (config) {
  // 在发送请求之前做些什么
  config.headers.token = window.localStorage.getItem('token');
  return config;
}, function (error) {
  return Promise.reject(error);
});
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="部署"><a class="header" href="#部署">部署</a></h1>
<p>完成开发并且在开发环境验证之后，就需要部署给我们的用户了。</p>
<p><img src="delicate-web/zh-cn/../_media/term_build.svg" alt="i18n" /></p>
<h2 id="构建"><a class="header" href="#构建">构建</a></h2>
<p>先执行下面的命令，</p>
<pre><code class="language-bash">npm run build
</code></pre>
<p>几秒后，输出应该如下：</p>
<pre><code class="language-bash">&gt; delicate-rs@5.0.0-beta build /Users/delicate/delicate-web
&gt; umi build

[21:13:17] webpack compiled in 43s 868ms
 DONE  Compiled successfully in 43877ms          21:13:17

File sizes after gzip:

  1.3 MB     dist/vendors.async.js
  308.21 KB  dist/umi.js
  45.49 KB   dist/vendors.chunk.css
  36.08 KB   dist/p__chart__highCharts__index.async.js
  33.53 KB   dist/p__user__index.async.js
  22.36 KB   dist/p__chart__ECharts__index.async.js
  4.21 KB    dist/p__dashboard__index.async.js
  4.06 KB    dist/umi.css
  ...
</code></pre>
<p><code>build</code> 命令会打包所有的资源，包含 JavaScript, CSS, web fonts, images, html 等。你可以在 <code>dist/</code> 目录下找到这些文件。</p>
<blockquote>
<p>如果有使用 HashHistory 、 部署 html 到非根目录、静态化等需求，请查看<a href="https://umijs.org/zh/guide/deploy.html">Umi 部署</a>。</p>
</blockquote>
<h2 id="本地验证"><a class="header" href="#本地验证">本地验证</a></h2>
<p>发布之前，可以通过 <code>serve</code> 做本地验证，</p>
<pre><code>$ yarn global add serve
$ serve ./dist

Serving!

- Local:            http://localhost:5000
- On Your Network:  http://{Your IP}:5000

Copied local address to clipboard!

</code></pre>
<p>访问 <a href="http://localhost:5000">http://localhost:5000</a>，正常情况下法应该是和 <code>npm start</code> 一致的（接口可能无法获取到正确数据）。</p>
<h2 id="部署-1"><a class="header" href="#部署-1">部署</a></h2>
<p>接下来，我们可以把静态文件上传到服务器，如果使用 Nginx 作为 Web server，你可以在 <code>ngnix.conf</code> 中这样配置：</p>
<pre><code>server
	{
		listen       80;
        # 指定可访问的域名
		server_name web.delicate-rs.com;
        # 编译后的文件存放的目录
		root  /home/www/delicate-web/dist;

        # 代理服务端接口，避免跨域
		location /api {
			 proxy_pass http://*.*.*.*:8090/api;
		}

        # 因为前端使用了BrowserHistory，所以将路由 fallback 到 index.html
		location / {
				index  index.html;
				try_files $uri $uri/ /index.html;
		}
	}
</code></pre>
<p>重启 Web server，访问 <a href="http://web.delicate-rs.com">http://web.delicate-rs.com</a> ，你将看到正确的页面。</p>
<pre><code class="language-bash">nginx -s reload
</code></pre>
<p>类似的，如果你使用 Caddy 作为 Web server，你可以在 <code>Caddyfile</code> 中这样配置：</p>
<pre><code>web.delicate-rs.com {
        gzip
        root /home/www/delicate-web/dist
        proxy /api http://localhost:7000

        rewrite {
                if {path} not_match ^/api
                to {path} {path}/ /
        }
}


web.delicate-rs.com/public {
        gzip
        root  /home/www/delicate-web/dist/static/public
}

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="500-1"><a class="header" href="#500-1">5.0.0</a></h2>
<h4 id="优化"><a class="header" href="#优化">优化</a></h4>
<ul>
<li>
<p>尽量使用修饰器，简化代码编写，提高代码可读性。</p>
</li>
<li>
<p>API 配置化，简化获取数据方式。</p>
</li>
<li>
<p><code>utils</code> 内文件拆分，各司其职。</p>
</li>
<li>
<p>简化<code>utils/request</code>文件，不做特殊处理。</p>
</li>
</ul>
<h4 id="规范"><a class="header" href="#规范">规范</a></h4>
<ul>
<li>
<p>函数添加描述、参数、返回值等注释，含糊不清的代码增加注释，规范参考 <a href="https://google.github.io/styleguide/jsguide.html#appendices-jsdoc-tag-reference">Google JavaScript Style Guide</a>。</p>
</li>
<li>
<p>语义化版本号，规范参加 <a href="https://semver.org/lang/zh-CN/">语义化版本 2.0.0</a>。</p>
</li>
<li>
<p>静态代码检查，统一代码风格，代码提交前将会使用 <code>prettier</code>、<code>stylelint</code>、<code>eslint</code> 规范代码。</p>
</li>
<li>
<p>Git 提交信息规范化，<a href="https://github.com/liuchengxu/git-commit-emoji-cn">git-commit-emoji-cn</a>。</p>
</li>
<li>
<p>基于 <code>Umi</code> 的约定式路由，无需再写路由配置文件。</p>
</li>
<li>
<p>使用 <code>React 16</code> 新特性，如 <code>Fragment</code>、<code>Context</code>、 <code>PureComponent</code>等。</p>
</li>
</ul>
<h4 id="功能"><a class="header" href="#功能">功能</a></h4>
<ul>
<li>
<p>支持国际化，源码中抽离翻译字段，按需加载语言包，自动在线翻译。</p>
</li>
<li>
<p>支持按需引入 <code>lodash</code> 函数。</p>
</li>
<li>
<p>支持多布局，可根据规则规定哪些路由使用哪种布局。</p>
</li>
<li>
<p>支持 Antd Admin 在 Travis 上自动编译和部署。</p>
</li>
<li>
<p>使用 <code>Docsify</code> 生成文档网站。</p>
</li>
</ul>
<h4 id="样式"><a class="header" href="#样式">样式</a></h4>
<ul>
<li>
<p>新增 Antd Admin 独立 Logo。</p>
</li>
<li>
<p>重写整体布局组件，优化菜单、面包屑导航自动高亮，菜单自动展开等逻辑。</p>
</li>
<li>
<p>移动端菜单更改为抽屉式。</p>
</li>
</ul>
<h4 id="其他"><a class="header" href="#其他">其他</a></h4>
<ul>
<li>废弃 <code>IconFont</code>、 <code>Search</code>、<code>DataTable</code>等组件，因为在 <code>Antd</code> 中有很好的支持和可替代的。</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
    </body>
</html>
